<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="http://malsup.github.io/jquery.cycle.all.js"></script>
        <title></title>
<script type="text/javascript">
divid='div2'; //в объект с индексом 'div2' будем выводить в реальном времени нашу таблицу table1


//функция "posting",служит для добавления двух текстовых полей из html-странички в базу данных
function posting(id1, id2, id3, id4, id5, id6) //начало функции, в функцию передаются id элементов двух текстовых полей, из которых будет забираться информация в БД
{
num1=document.getElementById(id1).value; //текстовое поле №1 заносится в переменную abc1
num2=document.getElementById(id2).value; //текстовое поле №2 заносится в переменную abc2
num3=document.getElementById(id3).value;
num4=document.getElementById(id4).value;
num5=document.getElementById(id5).value;
num6=document.getElementById(id6).value;

alert(num1+' '+num2+' '+num3+' '+num4+' '+num5+' '+num6);

var oXmlHttp = createXMLHttp();			//создание объекта oxmlhttp с помощью функции createXMLHttp, приведенной ниже
oXmlHttp.open("post", "ajax_config/change_table.php", true); //подключение php-сценария, используется метод POST, и асинхронный способ связи с сервером(true)
oXmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");//это заголовок, он ОБЯЗАТЕЛЕН при методе POST, не забудь выбрать нужную кодировку
oXmlHttp.send('info1='+num1+'&info2='+num2+'&info3='+num3+'&info4='+num4+'&info5='+num5+'&info6='+num6);//отправка данных из текстовых полей на php-сервер

oXmlHttp.onreadystatechange = function() 	//перехват и обработка ответа сервера		
 	{if(oXmlHttp.readyState == 4) 		//данное состояние объекта oXmlHttp означает, что Все данные были переданы и соединение закрыто, 
						//только при этом состоянии 
						//мы обращаемся к свойству responseText, в котором и передается вся html-разметка и данные,
						// отправленные нам php-сценарием сервера 

   	 	{if(oXmlHttp.status == 200) 	//Свойство status содержит код статуса HTTP, передаваемое в ответа, 
						//а свойство statusText - текст описание статуса (например "ОК"
						//или "Not found"). Эти два метода позволяют убедиться, что получены именно те данные, 
						//которые вы запрашивали, или сообщить пользователю о возникшей ошибке:

	 	 	{a = oXmlHttp.responseText; //полученные данные записываются в виде текста в переменную a, и выводятся с помощью innerhtml в следующей функции obnovit()
	 		 //alert("Получены следующие данные: " + oXmlHttp.responseText); //раскоментируйте для вывода на экран сообщения с информацией от сервера
     	 		} 
			else {displayCustomerInfo("Ошибка: " + oXmlHttp.statusText);} //обработчик на случай, если возникнет ошибка получения данных
   		}
 	};					//конец перехвата

}//--------------------------конец функции "posting"



//функция обновления таблицы, которая обновляется каждые 2000 милисекунд с помощью таймера поставленного в начале html setInterval(obnovit, 2000);
function obnovit()
{
var oXmlHttp = createXMLHttp();
oXmlHttp.open("post", "ajax_config/refresh_table.php", true);
oXmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");
oXmlHttp.send(null);
oXmlHttp.onreadystatechange = function() 	//перехват и обработка ответа сервера		
 	{if(oXmlHttp.readyState == 4) 
   	 	{if(oXmlHttp.status == 200) 
	 	 	{a = oXmlHttp.responseText;
	 		 document.getElementById(divid).innerHTML=a;	//вставка полученного ответа сервера в div, с помощью свойства innerhtml и id элемента, id был задан в самом начале, то есть можно выводить в любой div, зная его id
     	 		} 
			else {displayCustomerInfo("Ошибка: " + oXmlHttp.statusText);}
   		}
 	};

}
//-------------------------------------------------	



//функция для создания объекта xmlhttp, ключевого в ajax, работает в старых версиях IE----------------
 function createXMLHttp() {
        if(typeof XMLHttpRequest != "undefined") { // для браузеров аля Mozilla
          return new XMLHttpRequest();
        } else if(window.ActiveXObject) { // для Internet Explorer (all versions)
          var aVersions = ["MSXML2.XMLHttp.5.0", "MSXML2.XMLHttp.4.0",
                   "MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp",
                   "Microsoft.XMLHttp"
                   ];
          for (var i = 0; i < aVersions.length; i++) {
            try { //
              var oXmlHttp = new ActiveXObject(aVersions[i]);
              alert(aVersions[i]);
              return oXmlHttp;
            } catch (oError) {
              /* поскольку это элемент управления ActiveX, любая ошибка создания объекта будет
                возбуждать исключительную ситуацию, а это означает что попытке создания
                объекта необходимо предпринимать внутри конструкции try...catch.
                
                 В данном случае, если обнаружена ошибка, мы
                 ничего не делаем, создать объект с данной версией компонента не удалось.
               */
            }
          }
          throw new Error("Невозможно создать объект XMLHttp.");
        }
      }
//-----------------------------------------------------


</script> <!--конец javascript и начало html, соответственно меняется и обозначение комментариев-->

    </head>
    <body onLoad="setInterval(obnovit, 2000);">
        <div id="hidden-div" style="display:none;">Пожалуйста выберите во всех полях те числа, на которые вы желаете сделать ставку.</div>
        <br>
        <hr>
        <br>
        <br>
        <br>
        <center><form>	
            <select class="formSelect" name="priority1" onChange="p1(priority1);" onClick="p1(priority1);" width="175px" id="priority1" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>     
            <select name="priority2" class="chidden" onChange="p2(priority2);" onClick="p2(priority2);" width="175px" id="priority2" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>     
            <select name="priority3" class="chidden" onChange="p3(priority3);" onClick="p3(priority3);" width="175px" id="priority3" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>          
            <select name="priority4" class="chidden" onChange="p4(priority4);" onClick="p4(priority4);" width="175px" id="priority4" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>
            <select name="priority5" class="chidden" onChange="p5(priority5);" onClick="p5(priority5);" width="175px" id="priority5" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>    
            <select name="priority6" class="chidden" width="175px" id="priority6" size="1" tabindex="22";>
                <option value="0" id="noselect">No Preference</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>
            <br>
            <br>
            <br>
            <hr>
            <input type="checkbox" value="my" id="checkForm">Я подтверждаю что правильно указал все сектора и готов сделать ставку.
            <br>
            <br>
            <br>
            <center>
                <input type="button" id="mysubmit" value="СДЕЛАТЬ СТАВКУ!" onclick="posting('priority1', 'priority2', 'priority3', 'priority4', 'priority5', 'priority6')">
            </center> 
            </form>
        </center>

<center><div style="width:600;height:200; background-color:white" id="div2">текст</div></center>
    <script>
            $('select').change(function()   {
                var sel = $(this); 
                var data = sel.data('prev'); 
                var val = sel.val();
                var prev; 
                if(data)    { 
                    prev = data.val; 
                }
                sel.data('prev', {val: val}); 
                sel.nextAll().each(function()   {
                
                    if(prev)    {
                        $(this).find("[value='" + prev+ "']").prop("disabled",false);
                    }
                    $(this).find("[value='" + val + "']").prop("disabled",true);
                });
    
            sel.prevAll().each(function()   {
            if(prev)    {
                $(this).find("[value='" + prev+ "']").prop("disabled",false);
            }
            $(this).find("[value='" + val + "']").prop("disabled",true);
            });
            });
        </script>
        <script>
            selectGameSectors();
            $("select").change(selectGameSectors);

            function selectGameSectors() {
                var yesFound = false;
                $("select").each(function(index, element) {
                    if ( $(element).val() == "0" ) {
                        yesFound = true;
                    }
                });

                if (yesFound) {
                    $("#hidden-div").show();
                    $("input:checkbox").attr("disabled","disabled");
                } else {
                    $("#hidden-div").hide();
                    $("input:checkbox").removeAttr("disabled");
                };
            }
            
            finalChecking();
            $("#checkForm").click(finalChecking);
            
            function finalChecking() {
                if ($(this).is(':checked')) {
                    $('#mysubmit').removeAttr('disabled'); 
                    $('#priority1').attr('disabled', 'disabled');
                    $('#priority2').attr('disabled', 'disabled');
                    $('#priority3').attr('disabled', 'disabled');
                    $('#priority4').attr('disabled', 'disabled');
                    $('#priority5').attr('disabled', 'disabled');
                    $('#priority6').attr('disabled', 'disabled');
                } else {
                    $('#mysubmit').attr('disabled', 'disabled');
                    $('#priority1').removeAttr('disabled'); 
                    $('#priority2').removeAttr('disabled'); 
                    $('#priority3').removeAttr('disabled'); 
                    $('#priority4').removeAttr('disabled'); 
                    $('#priority5').removeAttr('disabled'); 
                    $('#priority6').removeAttr('disabled'); 
                }
            }
        </script>
  </body>
</html>
